<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Daily Missions | NextBloom - AI-Powered Learning Platform</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  <script src="https://unpkg.com/scrollreveal"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body {
      font-family: 'Inter', sans-serif;
      scroll-behavior: smooth;
    }
    
    .glass {
      background: rgba(255, 255, 255, 0.25);
      backdrop-filter: blur(20px);
      border: 1px solid rgba(255, 255, 255, 0.18);
    }
    
    .glass-dark {
      background: rgba(0, 0, 0, 0.1);
      backdrop-filter: blur(20px);
      border: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    .gradient-text {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    
    .floating-animation {
      animation: float 6s ease-in-out infinite;
    }
    
    @keyframes float {
      0%, 100% { transform: translateY(0px); }
      50% { transform: translateY(-20px); }
    }
    
    .feature-card {
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }
    
    .feature-card:hover {
      transform: translateY(-4px);
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
    }
    
    .hero-bg {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      position: relative;
      overflow: hidden;
    }
    
    .hero-bg::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1000 1000"><defs><radialGradient id="a" cx="50%" cy="50%" r="50%"><stop offset="0%" stop-color="%23ffffff" stop-opacity="0.1"/><stop offset="100%" stop-color="%23ffffff" stop-opacity="0"/></radialGradient></defs><circle cx="200" cy="200" r="100" fill="url(%23a)"/><circle cx="800" cy="300" r="150" fill="url(%23a)"/><circle cx="400" cy="700" r="120" fill="url(%23a)"/></svg>');
      opacity: 0.3;
    }
    
    .scroll-indicator {
      position: fixed;
      top: 0;
      left: 0;
      height: 4px;
      background: linear-gradient(90deg, #667eea, #764ba2);
      z-index: 100;
      transition: width 0.3s ease;
    }

    .mobile-menu {
      transform: translateX(100%);
      transition: transform 0.3s ease-in-out;
    }

    .mobile-menu.show {
      transform: translateX(0);
    }

    .progress-bar {
      transition: width 0.5s ease-in-out;
    }

    .mission-card {
      background: rgba(255, 255, 255, 0.9);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.2);
      transition: all 0.3s ease;
    }

    .mission-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 15px 35px rgba(102, 126, 234, 0.2);
    }

    .mission-completed {
      background: rgba(34, 197, 94, 0.1);
      border: 1px solid rgba(34, 197, 94, 0.3);
    }

    .mission-locked {
      background: rgba(107, 114, 128, 0.1);
      border: 1px solid rgba(107, 114, 128, 0.3);
      opacity: 0.6;
    }

    .streak-flame {
      animation: flicker 2s ease-in-out infinite alternate;
    }

    @keyframes flicker {
      0%, 100% { transform: scale(1) rotate(-2deg); }
      50% { transform: scale(1.1) rotate(2deg); }
    }

    .xp-bar {
      background: linear-gradient(90deg, #667eea, #764ba2);
      animation: shimmer 2s ease-in-out infinite;
    }

    @keyframes shimmer {
      0% { background-position: -200% 0; }
      100% { background-position: 200% 0; }
    }

    .achievement-badge {
      animation: bounce 2s ease-in-out infinite;
    }

    @keyframes bounce {
      0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
      40% { transform: translateY(-10px); }
      60% { transform: translateY(-5px); }
    }

    .pulse-ring {
      animation: pulse-ring 2s cubic-bezier(0.455, 0.03, 0.515, 0.955) infinite;
    }

    @keyframes pulse-ring {
      0% {
        transform: scale(0.8);
        opacity: 1;
      }
      80%, 100% {
        transform: scale(1.2);
        opacity: 0;
      }
    }

    .difficulty-easy { border-left: 4px solid #10b981; }
    .difficulty-medium { border-left: 4px solid #f59e0b; }
    .difficulty-hard { border-left: 4px solid #ef4444; }
    .difficulty-expert { border-left: 4px solid #8b5cf6; }

    .timer-circle {
      stroke-dasharray: 283;
      stroke-dashoffset: 283;
      transition: stroke-dashoffset 1s linear;
    }

    .leaderboard-item {
      transition: all 0.3s ease;
    }

    .leaderboard-item:hover {
      background: rgba(102, 126, 234, 0.1);
      transform: translateX(5px);
    }

    .notification-slide {
      animation: slideInRight 0.5s ease-out;
    }

    @keyframes slideInRight {
      from { transform: translateX(100%); opacity: 0; }
      to { transform: translateX(0); opacity: 1; }
    }

    .modal-backdrop {
      backdrop-filter: blur(10px);
      background: rgba(0, 0, 0, 0.5);
    }

    .modal-content {
      animation: modalSlideIn 0.3s ease-out;
    }

    @keyframes modalSlideIn {
      from { transform: scale(0.9) translateY(-20px); opacity: 0; }
      to { transform: scale(1) translateY(0); opacity: 1; }
    }

    .category-filter {
      transition: all 0.3s ease;
    }

    .category-filter.active {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      transform: scale(1.05);
    }

    .mission-timer {
      background: conic-gradient(from 0deg, #667eea, #764ba2, #667eea);
      animation: rotate 10s linear infinite;
    }

    @keyframes rotate {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }

    .reward-sparkle {
      animation: sparkle 1.5s ease-in-out infinite;
    }

    @keyframes sparkle {
      0%, 100% { opacity: 0; transform: scale(0); }
      50% { opacity: 1; transform: scale(1); }
    }

    /* Enhanced Mobile Responsiveness */
    @media (max-width: 640px) {
      .hero-bg {
        padding-top: 5rem;
        padding-bottom: 3rem;
      }
      
      .mission-card {
        padding: 1rem;
        margin-bottom: 1rem;
      }
      
      .glass {
        padding: 1rem;
      }
      
      .category-filter {
        font-size: 0.75rem;
        padding: 0.5rem 0.75rem;
        min-width: 80px;
        text-align: center;
      }
      
      .leaderboard-item {
        padding: 0.75rem;
        flex-direction: column;
        align-items: flex-start;
        gap: 0.5rem;
      }
      
      .modal-content {
        margin: 1rem;
        max-height: 85vh;
        overflow-y: auto;
      }
      
      /* Mission grid responsive */
      #missionGrid {
        grid-template-columns: 1fr;
        gap: 1rem;
      }
      
      /* Weekly grid responsive */
      #weeklyGrid {
        grid-template-columns: 1fr;
        gap: 1rem;
      }
      
      /* Stats grid responsive */
      .hero-bg .grid {
        grid-template-columns: repeat(2, 1fr);
        gap: 0.75rem;
      }
      
      /* Category filters responsive */
      .category-filter {
        flex: 1;
        min-width: 0;
      }
      
      /* Progress bars */
      .progress-bar {
        height: 0.5rem;
      }
    }

    @media (max-width: 480px) {
      .hero-bg h1 {
        font-size: 2rem;
        line-height: 1.2;
      }
      
      .hero-bg p {
        font-size: 0.875rem;
        padding: 0 1rem;
      }
      
      .mission-card h3 {
        font-size: 0.875rem;
      }
      
      .mission-card p {
        font-size: 0.75rem;
      }
      
      /* Ultra-small screens */
      .category-filter {
        font-size: 0.625rem;
        padding: 0.375rem 0.5rem;
      }
      
      .mission-card {
        padding: 0.75rem;
      }
      
      .glass {
        padding: 0.75rem;
      }
    }

    /* Tablet responsiveness */
    @media (min-width: 641px) and (max-width: 1024px) {
      #missionGrid {
        grid-template-columns: repeat(2, 1fr);
        gap: 1.5rem;
      }
      
      #weeklyGrid {
        grid-template-columns: repeat(2, 1fr);
        gap: 1.5rem;
      }
      
      .hero-bg .grid {
        grid-template-columns: repeat(4, 1fr);
        gap: 1rem;
      }
      
      .mission-card {
        padding: 1.25rem;
      }
    }

    /* Large tablet and small desktop */
    @media (min-width: 1025px) and (max-width: 1280px) {
      #missionGrid {
        grid-template-columns: repeat(3, 1fr);
        gap: 2rem;
      }
      
      #weeklyGrid {
        grid-template-columns: repeat(2, 1fr);
        gap: 2rem;
      }
    }

    /* Improved animations for mobile */
    @media (prefers-reduced-motion: reduce) {
      .floating-animation,
      .streak-flame,
      .achievement-badge,
      .pulse-ring {
        animation: none;
      }
    }

    /* Better touch targets for mobile */
    @media (max-width: 768px) {
      button, .mission-card, .category-filter {
        min-height: 44px;
      }
    }
  </style>
</head>
<body class="bg-gray-50 min-h-screen">
  <!-- Scroll Progress Indicator -->
  <div class="scroll-indicator" id="scrollIndicator"></div>

  <!-- Enhanced Navigation -->
  <nav id="navbar" class="fixed top-0 left-0 right-0 glass-dark z-50 transition-all duration-500 py-3 md:py-4">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex items-center justify-between">
        
        <!-- Brand Section -->
        <div class="flex items-center space-x-3 nav-brand">
          <div class="w-8 h-8 md:w-10 md:h-10 bg-gradient-to-r from-purple-500 to-blue-500 rounded-xl flex items-center justify-center shadow-lg">
            <i class="fas fa-graduation-cap text-white text-sm md:text-lg"></i>
          </div>
          <div>
            <h1 class="text-lg md:text-xl lg:text-2xl font-bold text-white transition-colors duration-300">NextBloom</h1>
            <p class="text-xs text-white/70 transition-all duration-300">Daily Missions</p>
          </div>
        </div>

        <!-- Desktop Navigation Links -->
        <div class="hidden md:flex items-center space-x-6 lg:space-x-8 nav-links">
          <a href="index.html" class="text-white/90 hover:text-white transition-all duration-300 font-medium relative group">
            Home
            <span class="absolute -bottom-1 left-0 w-0 h-0.5 bg-gradient-to-r from-purple-400 to-blue-400 transition-all duration-300 group-hover:w-full"></span>
          </a>
          <a href="dashboard.html" class="text-white/90 hover:text-white transition-all duration-300 font-medium relative group">
            Dashboard
            <span class="absolute -bottom-1 left-0 w-0 h-0.5 bg-gradient-to-r from-purple-400 to-blue-400 transition-all duration-300 group-hover:w-full"></span>
          </a>
          <a href="learning.html" class="text-white/90 hover:text-white transition-all duration-300 font-medium relative group">
            Learning
            <span class="absolute -bottom-1 left-0 w-0 h-0.5 bg-gradient-to-r from-purple-400 to-blue-400 transition-all duration-300 group-hover:w-full"></span>
          </a>
          <a href="mission.html" class="text-white font-semibold relative group">
            Missions
            <span class="absolute -bottom-1 left-0 w-full h-0.5 bg-gradient-to-r from-purple-400 to-blue-400"></span>
          </a>
        </div>

        <!-- CTA Button & Mobile Menu -->
        <div class="flex items-center space-x-2 md:space-x-3">
          <!-- Streak Counter -->
          <div class="flex items-center space-x-2 text-white bg-white/10 px-2 md:px-3 py-1 md:py-1.5 rounded-full backdrop-blur-sm border border-white/20">
            <i class="fas fa-fire streak-flame text-orange-400 text-sm"></i>
            <span class="font-semibold text-sm" id="streakCount">7</span>
            <span class="text-xs hidden sm:inline">streak</span>
          </div>
          
          <!-- User Section (shown when logged in) -->
          <div id="user-section" class="hidden md:flex items-center space-x-3">
            <div class="flex items-center space-x-2 bg-white/10 px-3 py-1.5 rounded-full backdrop-blur-sm border border-white/20">
              <i class="fas fa-user-circle text-white text-sm"></i>
              <span class="text-white text-xs">Welcome</span>
              <span id="user-display-name" class="text-white text-xs font-medium"></span>
            </div>
          
            <button id="logout-btn" class="bg-gradient-to-r from-red-500 to-pink-500 text-white px-3 py-1.5 rounded-full text-xs font-semibold hover:from-red-600 hover:to-pink-600 transition-all duration-300 shadow-lg hover:shadow-xl transform hover:scale-105">
              Logout
            </button>
          </div>
          
          <!-- Login/Signup Buttons (shown when not logged in) -->
          <div id="auth-buttons" class="hidden md:flex items-center space-x-2">
            <a href="login.html" class="bg-gradient-to-r from-green-500 to-green-600 text-white px-3 py-1.5 rounded-full text-xs font-semibold hover:from-green-400 hover:to-green-600 transition-all duration-300 shadow-lg hover:shadow-xl transform hover:scale-105">
              Login
            </a>
            <a href="signup.html" class="bg-gradient-to-r from-purple-500 to-blue-500 text-white px-3 py-1.5 rounded-full text-xs font-semibold hover:from-purple-600 hover:to-blue-600 transition-all duration-300 shadow-lg hover:shadow-xl transform hover:scale-105">
              Sign Up
            </a>
          </div>
          
          <!-- Mobile Menu Button -->
          <button id="mobile-menu-btn" class="md:hidden text-white p-2 rounded-lg hover:bg-white/10 transition-colors duration-300">
            <i class="fas fa-bars text-lg"></i>
          </button>
        </div>
      </div>
    </div>

    <!-- Mobile Menu -->
    <div id="mobile-menu" class="mobile-menu md:hidden absolute top-full left-0 right-0 bg-white/95 backdrop-blur-lg shadow-xl">
      <div class="px-4 py-4 space-y-3">
        <a href="index.html" class="block text-gray-800 font-medium py-2 hover:text-purple-600 transition-colors duration-300">
          <i class="fas fa-home w-5 mr-3"></i>Home
        </a>
        <a href="dashboard.html" class="block text-gray-800 font-medium py-2 hover:text-purple-600 transition-colors duration-300">
          <i class="fas fa-tachometer-alt w-5 mr-3"></i>Dashboard
        </a>
        <a href="learning.html" class="block text-gray-800 font-medium py-2 hover:text-purple-600 transition-colors duration-300">
          <i class="fas fa-book w-5 mr-3"></i>Learning
        </a>
        <a href="mission.html" class="block text-purple-600 font-semibold py-2">
          <i class="fas fa-trophy w-5 mr-3"></i>Missions
        </a>
        
        <!-- Mobile User Section -->
        <div id="mobile-user-section" class="hidden pt-3 border-t border-gray-200">
          <div class="flex items-center space-x-2 mb-3">
            <i class="fas fa-user-circle text-gray-600"></i>
            <span class="text-gray-600 text-sm">Welcome</span>
            <span id="mobile-user-display-name" class="text-gray-800 text-sm font-medium"></span>
          </div>
          <button id="mobile-logout-btn" class="w-full bg-gradient-to-r from-red-500 to-pink-500 text-white px-4 py-2 rounded-full font-semibold hover:from-red-600 hover:to-pink-600 transition-all duration-300 shadow-lg">
            <i class="fas fa-sign-out-alt mr-2"></i>Logout
          </button>
        </div>
        
        <!-- Mobile Auth Buttons -->
        <div id="mobile-auth-buttons" class="pt-3 border-t border-gray-200 space-y-2">
          <a href="login.html" class="block w-full bg-gradient-to-r from-green-500 to-green-600 text-white px-4 py-2 rounded-full font-semibold text-center hover:from-green-400 hover:to-green-600 transition-all duration-300 shadow-lg">
            Login
          </a>
          <a href="signup.html" class="block w-full bg-gradient-to-r from-purple-500 to-blue-500 text-white px-4 py-2 rounded-full font-semibold text-center hover:from-purple-600 hover:to-blue-600 transition-all duration-300 shadow-lg">
            Sign Up
          </a>
        </div>
      </div>
    </div>
  </nav>

  <!-- Hero Section -->
  <section class="hero-bg pt-20 md:pt-24 pb-12 md:pb-16 relative">
    <!-- Floating Elements -->
    <div class="absolute -top-10 -left-10 md:-top-20 md:-left-20 w-20 h-20 md:w-40 md:h-40 bg-white/10 rounded-full floating-animation"></div>
    <div class="absolute -bottom-10 -right-10 md:-bottom-20 md:-right-20 w-30 h-30 md:w-60 md:h-60 bg-white/5 rounded-full floating-animation" style="animation-delay: -3s;"></div>
    
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10">
      <div class="text-center mb-8 md:mb-12">
        <!-- Mission Badge -->
        <div class="inline-block bg-white/20 backdrop-blur-sm border border-white/30 rounded-full px-4 py-2 md:px-6 md:py-2 mb-4 md:mb-6">
          <span class="text-white/90 text-xs md:text-sm font-medium">üéØ Daily Mission Center</span>
        </div>
        
        <h1 class="text-3xl sm:text-4xl md:text-5xl lg:text-6xl font-bold text-white mb-4 md:mb-6 floating-animation leading-tight">
          Daily <span class="bg-gradient-to-r from-yellow-300 to-orange-300 bg-clip-text text-transparent">Missions</span>
        </h1>
        <p class="text-base sm:text-lg md:text-xl text-white/90 mb-6 md:mb-8 max-w-3xl mx-auto leading-relaxed px-4">
          Complete daily challenges, earn XP, unlock achievements, and climb the leaderboard!
        </p>
        
        <!-- Stats Overview -->
        <div class="grid grid-cols-2 md:grid-cols-4 gap-3 sm:gap-4 md:gap-6 max-w-4xl mx-auto">
          <div class="glass rounded-xl md:rounded-2xl p-3 sm:p-4 md:p-6 text-center">
            <div class="w-8 h-8 sm:w-10 sm:h-10 md:w-12 md:h-12 bg-gradient-to-r from-green-400 to-blue-500 rounded-lg md:rounded-xl flex items-center justify-center mx-auto mb-2 md:mb-3">
              <i class="fas fa-star text-white text-sm md:text-xl"></i>
            </div>
            <div class="text-lg sm:text-xl md:text-3xl font-bold text-white mb-1 md:mb-2" id="totalXP">2,450</div>
            <div class="text-white/80 text-xs md:text-sm">Total XP</div>
          </div>
          <div class="glass rounded-xl md:rounded-2xl p-3 sm:p-4 md:p-6 text-center">
            <div class="w-8 h-8 sm:w-10 sm:h-10 md:w-12 md:h-12 bg-gradient-to-r from-purple-400 to-pink-500 rounded-lg md:rounded-xl flex items-center justify-center mx-auto mb-2 md:mb-3">
              <i class="fas fa-check-circle text-white text-sm md:text-xl"></i>
            </div>
            <div class="text-lg sm:text-xl md:text-3xl font-bold text-white mb-1 md:mb-2" id="completedMissions">23</div>
            <div class="text-white/80 text-xs md:text-sm">Completed</div>
          </div>
          <div class="glass rounded-xl md:rounded-2xl p-3 sm:p-4 md:p-6 text-center">
            <div class="w-8 h-8 sm:w-10 sm:h-10 md:w-12 md:h-12 bg-gradient-to-r from-orange-400 to-red-500 rounded-lg md:rounded-xl flex items-center justify-center mx-auto mb-2 md:mb-3">
              <i class="fas fa-fire text-white text-sm md:text-xl"></i>
            </div>
            <div class="text-lg sm:text-xl md:text-3xl font-bold text-white mb-1 md:mb-2" id="currentStreak">7</div>
            <div class="text-white/80 text-xs md:text-sm">Day Streak</div>
          </div>
          <div class="glass rounded-xl md:rounded-2xl p-3 sm:p-4 md:p-6 text-center">
            <div class="w-8 h-8 sm:w-10 sm:h-10 md:w-12 md:h-12 bg-gradient-to-r from-teal-400 to-green-500 rounded-lg md:rounded-xl flex items-center justify-center mx-auto mb-2 md:mb-3">
              <i class="fas fa-trophy text-white text-sm md:text-xl"></i>
            </div>
            <div class="text-lg sm:text-xl md:text-3xl font-bold text-white mb-1 md:mb-2" id="currentRank">#12</div>
            <div class="text-white/80 text-xs md:text-sm">Rank</div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Main Content -->
  <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6 md:py-12">
    <!-- Mission Categories Filter -->
    <div class="mb-6 md:mb-8">
      <div class="flex flex-wrap gap-2 sm:gap-3 md:gap-4 justify-center">
        <button class="category-filter active px-3 sm:px-4 md:px-6 py-2 md:py-3 rounded-full font-medium transition-all text-sm md:text-base" data-category="all">
          All Missions
        </button>
        <button class="category-filter px-3 sm:px-4 md:px-6 py-2 md:py-3 rounded-full font-medium bg-white shadow-md hover:shadow-lg transition-all text-sm md:text-base" data-category="learning">
          <i class="fas fa-book mr-1 md:mr-2"></i><span class="hidden sm:inline">Learning</span>
        </button>
        <button class="category-filter px-3 sm:px-4 md:px-6 py-2 md:py-3 rounded-full font-medium bg-white shadow-md hover:shadow-lg transition-all text-sm md:text-base" data-category="practice">
          <i class="fas fa-code mr-1 md:mr-2"></i><span class="hidden sm:inline">Practice</span>
        </button>
        <button class="category-filter px-3 sm:px-4 md:px-6 py-2 md:py-3 rounded-full font-medium bg-white shadow-md hover:shadow-lg transition-all text-sm md:text-base" data-category="social">
          <i class="fas fa-users mr-1 md:mr-2"></i><span class="hidden sm:inline">Social</span>
        </button>
        <button class="category-filter px-3 sm:px-4 md:px-6 py-2 md:py-3 rounded-full font-medium bg-white shadow-md hover:shadow-lg transition-all text-sm md:text-base" data-category="challenge">
          <i class="fas fa-trophy mr-1 md:mr-2"></i><span class="hidden sm:inline">Challenge</span>
        </button>
      </div>
    </div>

    <!-- Daily Mission Timer -->
    <div class="mb-8 md:mb-12 text-center">
      <div class="glass rounded-xl md:rounded-2xl p-4 sm:p-6 md:p-8 max-w-sm md:max-w-md mx-auto">
        <h3 class="text-lg sm:text-xl md:text-2xl font-bold gradient-text mb-3 md:mb-4">Time Until Reset</h3>
        <div class="relative w-24 h-24 sm:w-28 sm:h-28 md:w-32 md:h-32 mx-auto mb-3 md:mb-4">
          <svg class="w-full h-full transform -rotate-90">
            <circle cx="50%" cy="50%" r="40%" stroke="currentColor" stroke-width="6" fill="transparent" class="text-gray-200"/>
            <circle cx="50%" cy="50%" r="40%" stroke="currentColor" stroke-width="6" fill="transparent" 
                    class="text-purple-500 timer-circle" id="timerCircle"/>
          </svg>
          <div class="absolute inset-0 flex items-center justify-center">
            <div class="text-center">
              <div class="text-lg sm:text-xl md:text-2xl font-bold gradient-text" id="timeRemaining">14:32:15</div>
            </div>
          </div>
        </div>
        <p class="text-gray-600 text-sm md:text-base">New missions unlock daily at midnight</p>
      </div>
    </div>

    <!-- Mission Grid -->
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6 md:gap-8 mb-8 md:mb-12" id="missionGrid">
      <!-- Daily Missions will be populated here -->
    </div>

    <!-- Weekly Challenges -->
    <section class="mb-8 md:mb-12">
      <h2 class="text-2xl sm:text-3xl font-bold gradient-text mb-6 md:mb-8 text-center">Weekly Challenges</h2>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4 sm:gap-6 md:gap-8" id="weeklyGrid">
        <!-- Weekly challenges will be populated here -->
      </div>
    </section>

    <!-- Leaderboard -->
    <section class="mb-8 md:mb-12">
      <h2 class="text-2xl sm:text-3xl font-bold gradient-text mb-6 md:mb-8 text-center">Leaderboard</h2>
      <div class="glass rounded-xl md:rounded-2xl p-4 sm:p-6 md:p-8">
        <div class="space-y-3 md:space-y-4" id="leaderboard">
          <!-- Leaderboard will be populated here -->
        </div>
      </div>
    </section>

    <!-- Achievements -->
    <section class="mb-8 md:mb-12">
      <h2 class="text-2xl sm:text-3xl font-bold gradient-text mb-6 md:mb-8 text-center">Recent Achievements</h2>
      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6" id="achievementsGrid">
        <!-- Achievements will be populated here -->
      </div>
    </section>
  </main>

  <!-- Mission Detail Modal -->
  <div class="fixed inset-0 modal-backdrop hidden z-50" id="missionModal">
    <div class="flex items-center justify-center min-h-screen p-4">
      <div class="modal-content glass rounded-xl md:rounded-2xl p-4 sm:p-6 md:p-8 max-w-sm sm:max-w-md md:max-w-2xl w-full max-h-[90vh] overflow-y-auto">
        <div class="flex justify-between items-start mb-4 md:mb-6">
          <h3 class="text-lg sm:text-xl md:text-2xl font-bold gradient-text pr-4" id="modalTitle">Mission Title</h3>
          <button class="text-gray-500 hover:text-gray-700 flex-shrink-0" id="closeModal">
            <i class="fas fa-times text-lg md:text-xl"></i>
          </button>
        </div>
        <div id="modalContent">
          <!-- Modal content will be populated here -->
        </div>
      </div>
    </div>
  </div>

  <!-- Notification Toast -->
  <div class="fixed top-20 md:top-24 right-2 md:right-4 z-50 hidden notification-slide max-w-xs sm:max-w-sm" id="notification">
    <div class="glass rounded-lg p-3 md:p-4 shadow-lg">
      <div class="flex items-center space-x-2 md:space-x-3">
        <div class="flex-shrink-0">
          <i class="fas fa-check-circle text-green-500 text-lg md:text-xl"></i>
        </div>
        <div class="min-w-0">
          <p class="font-medium text-gray-900 text-sm md:text-base truncate" id="notificationTitle">Mission Completed!</p>
          <p class="text-xs md:text-sm text-gray-600 truncate" id="notificationMessage">You earned 50 XP</p>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Authentication Check - Redirect if not logged in
    function checkAuthentication() {
      const isLoggedIn = localStorage.getItem('userLoggedIn') === 'true';
      const userEmail = localStorage.getItem('userEmail');
      
      if (!isLoggedIn || !userEmail) {
        // Show login required message
        document.body.innerHTML = `
          <div class="min-h-screen bg-gradient-to-br from-purple-600 to-blue-600 flex items-center justify-center px-4">
            <div class="glass rounded-2xl p-8 max-w-md w-full text-center">
              <div class="w-16 h-16 bg-gradient-to-r from-red-500 to-pink-500 rounded-full flex items-center justify-center mx-auto mb-6">
                <i class="fas fa-lock text-white text-2xl"></i>
              </div>
              <h1 class="text-2xl font-bold text-white mb-4">Login Required</h1>
              <p class="text-white/80 mb-6">You need to be logged in to access daily missions and track your progress.</p>
              <div class="space-y-3">
                <a href="login.html" class="block w-full bg-gradient-to-r from-green-500 to-green-600 text-white px-6 py-3 rounded-full font-semibold hover:from-green-400 hover:to-green-600 transition-all duration-300 shadow-lg">
                  Login Now
                </a>
                <a href="signup_new.html" class="block w-full bg-gradient-to-r from-purple-500 to-blue-500 text-white px-6 py-3 rounded-full font-semibold hover:from-purple-600 hover:to-blue-600 transition-all duration-300 shadow-lg">
                  Create Account
                </a>
                <a href="index.html" class="block text-white/70 hover:text-white transition-colors duration-300 text-sm">
                  ‚Üê Back to Home
                </a>
              </div>
            </div>
          </div>
        `;
        return false;
      }
      
      // Update UI with user info
      updateUserInterface(userEmail);
      return true;
    }

    // Update user interface with login info
    function updateUserInterface(userEmail) {
      const userData = localStorage.getItem('userData');
      let displayName = userEmail.split('@')[0];
      
      if (userData) {
        try {
          const user = JSON.parse(userData);
          displayName = user.firstName || displayName;
        } catch (error) {
          console.error('Error parsing user data:', error);
        }
      }
      
      // Show user sections, hide auth buttons
      const userSection = document.getElementById('user-section');
      const authButtons = document.getElementById('auth-buttons');
      const mobileUserSection = document.getElementById('mobile-user-section');
      const mobileAuthButtons = document.getElementById('mobile-auth-buttons');
      
      if (userSection) {
        userSection.classList.remove('hidden');
        document.getElementById('user-display-name').textContent = displayName;
      }
      if (authButtons) authButtons.classList.add('hidden');
      if (mobileUserSection) {
        mobileUserSection.classList.remove('hidden');
        document.getElementById('mobile-user-display-name').textContent = displayName;
      }
      if (mobileAuthButtons) mobileAuthButtons.classList.add('hidden');
      
      // Add logout functionality
      const logoutBtns = document.querySelectorAll('#logout-btn, #mobile-logout-btn');
      logoutBtns.forEach(btn => {
        btn.addEventListener('click', logout);
      });
    }

    // Logout function
    function logout() {
      localStorage.removeItem('userLoggedIn');
      localStorage.removeItem('userName');
      localStorage.removeItem('userEmail');
      localStorage.removeItem('userData');
      sessionStorage.clear();
      
      // Redirect to home page
      window.location.href = 'index.html';
    }

    // Data Persistence Manager
    class MissionDataManager {
      constructor() {
        const userEmail = localStorage.getItem('userEmail') || 'guest';
        this.storageKey = `missionData_${userEmail}`;
        this.dashboardKey = `dashboardData_${userEmail}`;
        this.userEmail = userEmail;
      }

      getData() {
        const defaultData = {
          totalXP: 2450,
          completedMissions: 23,
          currentStreak: 7,
          currentRank: 12,
          missions: [],
          weeklyProgress: {},
          achievements: [],
          lastUpdated: new Date().toISOString()
        };
        
        try {
          const stored = localStorage.getItem(this.storageKey);
          return stored ? { ...defaultData, ...JSON.parse(stored) } : defaultData;
        } catch (error) {
          console.error('Error loading mission data:', error);
          return defaultData;
        }
      }

      saveData(data) {
        try {
          localStorage.setItem(this.storageKey, JSON.stringify(data));
          this.updateDashboard(data);
          this.updateUI();
        } catch (error) {
          console.error('Error saving mission data:', error);
        }
      }

      updateDashboard(missionData) {
        try {
          // Get existing dashboard data
          const dashboardData = JSON.parse(localStorage.getItem(this.dashboardKey) || '{}');
          
          // Update dashboard with mission data
          dashboardData.totalXP = missionData.totalXP;
          dashboardData.completedMissions = missionData.completedMissions;
          dashboardData.currentStreak = missionData.currentStreak;
          dashboardData.achievements = missionData.achievements?.filter(a => a.earned)?.length || 0;
          dashboardData.lastMissionUpdate = new Date().toISOString();
          
          // Add recent activity for completed missions
          if (missionData.lastCompletedMission) {
            if (!dashboardData.recentActivity) dashboardData.recentActivity = [];
            dashboardData.recentActivity.unshift({
              type: 'mission',
              title: `Completed: ${missionData.lastCompletedMission.title}`,
              description: `Earned ${missionData.lastCompletedMission.xp} XP`,
              timestamp: new Date().toISOString(),
              id: Date.now()
            });
            // Keep only last 10 activities
            dashboardData.recentActivity = dashboardData.recentActivity.slice(0, 10);
          }
          
          localStorage.setItem(this.dashboardKey, JSON.stringify(dashboardData));
        } catch (error) {
          console.error('Error updating dashboard:', error);
        }
      }

      updateUI() {
        const data = this.getData();
        
        // Update hero stats
        document.getElementById('totalXP').textContent = data.totalXP.toLocaleString();
        document.getElementById('completedMissions').textContent = data.completedMissions;
        document.getElementById('currentStreak').textContent = data.currentStreak;
        document.getElementById('currentRank').textContent = `#${data.currentRank}`;
        
        // Update navbar streak
        document.getElementById('streakCount').textContent = data.currentStreak;
      }

      completeMission(mission) {
        const data = this.getData();
        
        // Update mission status
        const missionIndex = missions.findIndex(m => m.id === mission.id);
        if (missionIndex !== -1) {
          missions[missionIndex].completed = true;
        }
        
        // Update stats
        data.totalXP += mission.xp;
        data.completedMissions += 1;
        data.lastCompletedMission = mission;
        
        // Check for streak update (simplified logic)
        const today = new Date().toDateString();
        if (data.lastMissionDate !== today) {
          data.currentStreak += 1;
          data.lastMissionDate = today;
        }
        
        this.saveData(data);
        return data;
      }
    }

    // Initialize data manager
    const dataManager = new MissionDataManager();

    // Enhanced Mission data with more interesting challenges
    const missions = [
      {
        id: 1,
        title: "üéØ Daily Learning Sprint",
        description: "Complete 3 different learning modules in various subjects to boost your knowledge diversity",
        category: "learning",
        difficulty: "easy",
        xp: 75,
        timeEstimate: "25 min",
        completed: false,
        locked: false,
        icon: "fas fa-rocket",
        requirements: ["Access to learning modules"],
        rewards: ["75 XP", "Knowledge Explorer Badge", "Learning Streak +1"],
        progress: 0,
        target: 3
      },
      {
        id: 2,
        title: "üíª Code Master Challenge",
        description: "Solve 5 programming challenges across different difficulty levels and languages",
        category: "practice",
        difficulty: "medium",
        xp: 150,
        timeEstimate: "45 min",
        completed: false,
        locked: false,
        icon: "fas fa-code",
        requirements: ["Basic programming knowledge"],
        rewards: ["150 XP", "Code Warrior Badge", "Algorithm Points +25"],
        progress: 0,
        target: 5
      },
      {
        id: 3,
        title: "ü§ù Community Helper",
        description: "Help 3 fellow learners by answering their questions or providing feedback on projects",
        category: "social",
        difficulty: "easy",
        xp: 100,
        timeEstimate: "30 min",
        completed: false,
        locked: false,
        icon: "fas fa-hands-helping",
        requirements: ["Community access"],
        rewards: ["100 XP", "Mentor Badge Progress", "Community Points +15"],
        progress: 0,
        target: 3
      },
      {
        id: 4,
        title: "üß† AI Collaboration Quest",
        description: "Use the AI assistant to solve a complex problem, create a project plan, and get personalized learning recommendations",
        category: "learning",
        difficulty: "medium",
        xp: 120,
        timeEstimate: "35 min",
        completed: false,
        locked: false,
        icon: "fas fa-robot",
        requirements: ["AI Assistant access"],
        rewards: ["120 XP", "AI Collaborator Badge", "Smart Learning Points +20"],
        progress: 0,
        target: 3
      },
      {
        id: 5,
        title: "üèÜ Skill Mastery Challenge",
        description: "Achieve 95% accuracy in any advanced skill assessment and maintain it for 24 hours",
        category: "challenge",
        difficulty: "hard",
        xp: 250,
        timeEstimate: "60 min",
        completed: false,
        locked: false,
        icon: "fas fa-trophy",
        requirements: ["Complete 10 basic modules", "Maintain 5-day streak"],
        rewards: ["250 XP", "Skill Master Badge", "Premium Content Access", "Leaderboard Boost"],
        progress: 0,
        target: 1
      },
      {
        id: 6,
        title: "üìö Knowledge Synthesis",
        description: "Create a comprehensive study guide combining insights from 5 different subjects",
        category: "learning",
        difficulty: "medium",
        xp: 180,
        timeEstimate: "50 min",
        completed: false,
        locked: false,
        icon: "fas fa-book-open",
        requirements: ["Access to multiple subjects"],
        rewards: ["180 XP", "Knowledge Architect Badge", "Study Points +30"],
        progress: 0,
        target: 5
      },
      {
        id: 7,
        title: "‚ö° Speed Learning Challenge",
        description: "Complete 10 quick learning modules in under 60 minutes with 80%+ accuracy",
        category: "challenge",
        difficulty: "medium",
        xp: 200,
        timeEstimate: "60 min",
        completed: false,
        locked: false,
        icon: "fas fa-bolt",
        requirements: ["Fast learner status"],
        rewards: ["200 XP", "Speed Demon Badge", "Time Bonus +50"],
        progress: 0,
        target: 10
      },
      {
        id: 8,
        title: "üé® Creative Project Showcase",
        description: "Build and share a creative project using your learned skills (portfolio piece)",
        category: "practice",
        difficulty: "hard",
        xp: 300,
        timeEstimate: "90 min",
        completed: false,
        locked: false,
        icon: "fas fa-palette",
        requirements: ["Portfolio access", "Complete 5 practice modules"],
        rewards: ["300 XP", "Creator Badge", "Portfolio Highlight", "Showcase Points +40"],
        progress: 0,
        target: 1
      },
      {
        id: 9,
        title: "üåü Leadership Initiative",
        description: "Lead a study group, mentor 2 beginners, and organize a learning session",
        category: "social",
        difficulty: "hard",
        xp: 350,
        timeEstimate: "120 min",
        completed: false,
        locked: false,
        icon: "fas fa-users",
        requirements: ["Community leader status", "Help 10+ learners"],
        rewards: ["350 XP", "Leadership Badge", "Mentor Status", "Community Recognition"],
        progress: 0,
        target: 3
      },
      {
        id: 10,
        title: "üëë Grand Master Challenge",
        description: "Complete the ultimate test: solve expert-level problems across all categories in a single session",
        category: "challenge",
        difficulty: "expert",
        xp: 500,
        timeEstimate: "150 min",
        completed: false,
        locked: true,
        icon: "fas fa-crown",
        requirements: ["Complete 15 hard challenges", "Rank in top 25", "30-day streak"],
        rewards: ["500 XP", "Grand Master Badge", "Hall of Fame Entry", "Exclusive Perks", "Special Recognition"],
        progress: 0,
        target: 1
      },
      {
        id: 11,
        title: "üî¨ Research Explorer",
        description: "Dive deep into a cutting-edge topic, create a research summary, and share insights",
        category: "learning",
        difficulty: "hard",
        xp: 280,
        timeEstimate: "75 min",
        completed: false,
        locked: false,
        icon: "fas fa-microscope",
        requirements: ["Advanced learner status"],
        rewards: ["280 XP", "Research Badge", "Innovation Points +35"],
        progress: 0,
        target: 1
      },
      {
        id: 12,
        title: "üéÆ Gamified Learning Marathon",
        description: "Complete learning challenges in game-like scenarios with time pressure and bonus rounds",
        category: "challenge",
        difficulty: "medium",
        xp: 220,
        timeEstimate: "55 min",
        completed: false,
        locked: false,
        icon: "fas fa-gamepad",
        requirements: ["Gaming mode access"],
        rewards: ["220 XP", "Game Master Badge", "Fun Learning Points +25"],
        progress: 0,
        target: 8
      }
    ];

    const weeklyMissions = [
      {
        id: 'w1',
        title: "üèÉ‚Äç‚ôÇÔ∏è Knowledge Marathon",
        description: "Complete 15 learning modules across different subjects this week",
        progress: 8,
        target: 15,
        xp: 750,
        deadline: "4 days remaining",
        icon: "fas fa-running",
        category: "learning",
        bonus: "Double XP on final 3 modules"
      },
      {
        id: 'w2',
        title: "ü§ù Community Champion",
        description: "Help 8 different learners and receive 5+ positive feedback ratings",
        progress: 3,
        target: 8,
        xp: 600,
        deadline: "5 days remaining",
        icon: "fas fa-heart",
        category: "social",
        bonus: "Mentor Badge upgrade"
      },
      {
        id: 'w3',
        title: "üíª Code Warrior Week",
        description: "Solve 25 coding challenges with 90%+ accuracy rate",
        progress: 12,
        target: 25,
        xp: 800,
        deadline: "6 days remaining",
        icon: "fas fa-sword",
        category: "practice",
        bonus: "Exclusive algorithm masterclass access"
      },
      {
        id: 'w4',
        title: "üß† AI Collaboration Master",
        description: "Complete 10 AI-assisted projects and rate the experience",
        progress: 4,
        target: 10,
        xp: 650,
        deadline: "3 days remaining",
        icon: "fas fa-robot",
        category: "learning",
        bonus: "Early access to new AI features"
      }
    ];

    const leaderboardData = [
      { rank: 1, name: "Alex Chen", xp: 15420, streak: 45, avatar: "üë®‚Äçüíª" },
      { rank: 2, name: "Sarah Johnson", xp: 14890, streak: 32, avatar: "üë©‚Äçüéì" },
      { rank: 3, name: "Mike Rodriguez", xp: 13750, streak: 28, avatar: "üë®‚ÄçüöÄ" },
      { rank: 4, name: "Emily Davis", xp: 12980, streak: 41, avatar: "üë©‚Äçüíº" },
      { rank: 5, name: "David Kim", xp: 11650, streak: 19, avatar: "üë®‚Äçüî¨" },
      { rank: 6, name: "Lisa Wang", xp: 10890, streak: 23, avatar: "üë©‚Äçüè´" },
      { rank: 7, name: "James Wilson", xp: 9750, streak: 15, avatar: "üë®‚Äçüé®" },
      { rank: 8, name: "Anna Martinez", xp: 8920, streak: 31, avatar: "üë©‚Äç‚öïÔ∏è" },
      { rank: 9, name: "Tom Anderson", xp: 7850, streak: 12, avatar: "üë®‚Äçüè≠" },
      { rank: 10, name: "Rachel Green", xp: 6980, streak: 18, avatar: "üë©‚Äçüåæ" },
      { rank: 11, name: "Chris Taylor", xp: 5420, streak: 9, avatar: "üë®‚Äçüç≥" },
      { rank: 12, name: "You", xp: 2450, streak: 7, avatar: "üéØ", isCurrentUser: true }
    ];

    const achievements = [
      {
        id: 'a1',
        title: "üöÄ Mission Rookie",
        description: "Complete your first daily mission",
        icon: "fas fa-rocket",
        earned: true,
        rarity: "common",
        xpReward: 25
      },
      {
        id: 'a2',
        title: "üî• Streak Master",
        description: "Maintain a 7-day learning streak",
        icon: "fas fa-fire",
        earned: true,
        rarity: "uncommon",
        xpReward: 100
      },
      {
        id: 'a3',
        title: "üíª Code Virtuoso",
        description: "Solve 50 coding challenges with 85%+ accuracy",
        icon: "fas fa-code",
        earned: false,
        rarity: "rare",
        xpReward: 300,
        progress: 23,
        target: 50
      },
      {
        id: 'a4',
        title: "ü§ù Community Hero",
        description: "Help 25 fellow learners and receive 20+ positive ratings",
        icon: "fas fa-heart",
        earned: false,
        rarity: "uncommon",
        xpReward: 200,
        progress: 8,
        target: 25
      },
      {
        id: 'a5',
        title: "üß† AI Whisperer",
        description: "Complete 30 AI-assisted learning sessions",
        icon: "fas fa-robot",
        earned: false,
        rarity: "rare",
        xpReward: 250,
        progress: 12,
        target: 30
      },
      {
        id: 'a6',
        title: "‚ö° Speed Demon",
        description: "Complete 100 quick challenges in record time",
        icon: "fas fa-bolt",
        earned: false,
        rarity: "epic",
        xpReward: 500,
        progress: 34,
        target: 100
      },
      {
        id: 'a7',
        title: "üèÜ Champion",
        description: "Reach top 10 on the leaderboard",
        icon: "fas fa-crown",
        earned: false,
        rarity: "legendary",
        xpReward: 1000,
        progress: 0,
        target: 1
      },
      {
        id: 'a8',
        title: "üìö Knowledge Collector",
        description: "Complete modules in 10 different subject areas",
        icon: "fas fa-graduation-cap",
        earned: false,
        rarity: "rare",
        xpReward: 350,
        progress: 6,
        target: 10
      }
    ];

    // Initialize the page
    document.addEventListener('DOMContentLoaded', function() {
      // Check authentication first
      if (!checkAuthentication()) {
        return; // Stop initialization if not authenticated
      }
      
      initializeNavigation();
      initializeTimer();
      renderMissions();
      renderWeeklyMissions();
      renderLeaderboard();
      renderAchievements();
      initializeCategoryFilters();
      initializeScrollIndicator();
      dataManager.updateUI();
    });

    // Authentication state management
    function initializeAuthentication() {
      const isLoggedIn = localStorage.getItem('isLoggedIn') === 'true';
      const userName = localStorage.getItem('userName') || '';
      
      updateAuthUI(isLoggedIn, userName);
    }

    function updateAuthUI(isLoggedIn, userName = '') {
      const userSection = document.getElementById('user-section');
      const authButtons = document.getElementById('auth-buttons');
      const mobileUserSection = document.getElementById('mobile-user-section');
      const mobileAuthButtons = document.getElementById('mobile-auth-buttons');
      const userDisplayName = document.getElementById('user-display-name');
      const mobileUserDisplayName = document.getElementById('mobile-user-display-name');
      
      if (isLoggedIn && userName) {
        // Show user sections
        if (userSection) userSection.classList.remove('hidden');
        if (authButtons) authButtons.classList.add('hidden');
        if (mobileUserSection) mobileUserSection.classList.remove('hidden');
        if (mobileAuthButtons) mobileAuthButtons.classList.add('hidden');
        
        // Update display names
        if (userDisplayName) userDisplayName.textContent = userName;
        if (mobileUserDisplayName) mobileUserDisplayName.textContent = userName;
      } else {
        // Show auth buttons
        if (userSection) userSection.classList.add('hidden');
        if (authButtons) authButtons.classList.remove('hidden');
        if (mobileUserSection) mobileUserSection.classList.add('hidden');
        if (mobileAuthButtons) mobileAuthButtons.classList.remove('hidden');
      }
    }

    // Navigation functionality
    function initializeNavigation() {
      const mobileMenuBtn = document.getElementById('mobile-menu-btn');
      const mobileMenu = document.getElementById('mobile-menu');
      const logoutBtn = document.getElementById('logout-btn');
      const mobileLogoutBtn = document.getElementById('mobile-logout-btn');
      
      // Mobile menu toggle
      if (mobileMenuBtn && mobileMenu) {
        mobileMenuBtn.addEventListener('click', (e) => {
          e.stopPropagation();
          mobileMenu.classList.toggle('mobile-menu');
          mobileMenu.classList.toggle('active');
        });
      }

      // Close mobile menu when clicking outside
      document.addEventListener('click', (e) => {
        if (mobileMenu && !mobileMenu.contains(e.target) && !mobileMenuBtn?.contains(e.target)) {
          mobileMenu.classList.add('mobile-menu');
          mobileMenu.classList.remove('active');
        }
      });

      // Logout functionality
      function handleLogout() {
        localStorage.removeItem('isLoggedIn');
        localStorage.removeItem('userName');
        localStorage.removeItem('userEmail');
        updateAuthUI(false);
        showNotification('Logged Out', 'You have been successfully logged out');
        
        // Redirect to home page after a delay
        setTimeout(() => {
          window.location.href = 'index.html';
        }, 1500);
      }

      if (logoutBtn) logoutBtn.addEventListener('click', handleLogout);
      if (mobileLogoutBtn) mobileLogoutBtn.addEventListener('click', handleLogout);

      // Smooth scrolling for anchor links
      document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function (e) {
          e.preventDefault();
          const target = document.querySelector(this.getAttribute('href'));
          if (target) {
            target.scrollIntoView({
              behavior: 'smooth',
              block: 'start'
            });
          }
        });
      });
    }

    // Timer functionality
    function initializeTimer() {
      function updateTimer() {
        const now = new Date();
        const tomorrow = new Date(now);
        tomorrow.setDate(tomorrow.getDate() + 1);
        tomorrow.setHours(0, 0, 0, 0);
        
        const timeLeft = tomorrow - now;
        const hours = Math.floor(timeLeft / (1000 * 60 * 60));
        const minutes = Math.floor((timeLeft % (1000 * 60 * 60)) / (1000 * 60));
        const seconds = Math.floor((timeLeft % (1000 * 60)) / 1000);
        
        document.getElementById('timeRemaining').textContent = 
          `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
        
        // Update timer circle
        const totalSeconds = 24 * 60 * 60;
        const remainingSeconds = Math.floor(timeLeft / 1000);
        const progress = (totalSeconds - remainingSeconds) / totalSeconds;
        const circumference = 2 * Math.PI * 45;
        const offset = circumference * (1 - progress);
        
        document.getElementById('timerCircle').style.strokeDashoffset = offset;
      }
      
      updateTimer();
      setInterval(updateTimer, 1000);
    }

    // Render missions
    function renderMissions() {
      const grid = document.getElementById('missionGrid');
      grid.innerHTML = '';
      
      missions.forEach(mission => {
        const missionCard = createMissionCard(mission);
        grid.appendChild(missionCard);
      });
    }

    function createMissionCard(mission) {
      const card = document.createElement('div');
      card.className = `mission-card rounded-xl md:rounded-2xl p-4 sm:p-5 md:p-6 cursor-pointer transform transition-all duration-300 hover:scale-105 ${
        mission.completed ? 'mission-completed' : mission.locked ? 'mission-locked' : ''
      } difficulty-${mission.difficulty}`;
      
      // Calculate progress percentage
      const progressPercent = mission.target ? Math.round((mission.progress / mission.target) * 100) : 0;
      
      card.innerHTML = `
        <div class="flex items-start justify-between mb-3 md:mb-4">
          <div class="flex items-center space-x-2 md:space-x-3 flex-1 min-w-0">
            <div class="w-10 h-10 md:w-12 md:h-12 rounded-full bg-gradient-to-r from-purple-500 to-blue-500 flex items-center justify-center text-white flex-shrink-0 shadow-lg">
              <i class="${mission.icon} text-sm md:text-base"></i>
            </div>
            <div class="min-w-0 flex-1">
              <h3 class="font-bold text-gray-900 text-sm md:text-base lg:text-lg truncate">${mission.title}</h3>
              <div class="flex items-center space-x-1 md:space-x-2 text-xs md:text-sm text-gray-600">
                <span class="capitalize px-2 py-0.5 rounded-full text-xs ${getDifficultyColor(mission.difficulty)}">${mission.difficulty}</span>
                <span>‚Ä¢</span>
                <span class="flex items-center"><i class="fas fa-clock mr-1"></i>${mission.timeEstimate}</span>
              </div>
            </div>
          </div>
          <div class="text-right flex-shrink-0 ml-2">
            <div class="text-sm md:text-lg font-bold gradient-text">${mission.xp} XP</div>
            ${mission.completed ? '<i class="fas fa-check-circle text-green-500 text-lg md:text-xl"></i>' : 
              mission.locked ? '<i class="fas fa-lock text-gray-400 text-lg md:text-xl"></i>' : ''}
          </div>
        </div>
        
        <p class="text-gray-600 mb-3 md:mb-4 text-sm md:text-base leading-relaxed">${mission.description}</p>
        ${mission.target && mission.target > 1 ? `
          <div class="mb-3 md:mb-4">
            <div class="flex justify-between items-center mb-2">
              <span class="text-xs md:text-sm text-gray-600">Progress</span>
              <span class="text-xs md:text-sm font-semibold text-purple-600">${mission.progress}/${mission.target}</span>
            </div>
            <div class="w-full bg-gray-200 rounded-full h-2 md:h-3">
              <div class="bg-gradient-to-r from-purple-500 to-blue-500 h-2 md:h-3 rounded-full transition-all duration-500" style="width: ${progressPercent}%"></div>
            </div>
            <div class="text-xs text-gray-500 mt-1">${progressPercent}% complete</div>
          </div>
        ` : ''}
        
        <div class="flex flex-col sm:flex-row items-start sm:items-center justify-between gap-2 sm:gap-3">
          <div class="flex flex-wrap gap-1 sm:gap-2">
            <span class="px-2 md:px-3 py-1 bg-purple-100 text-purple-700 rounded-full text-xs md:text-sm font-medium capitalize">
              ${mission.category}
            </span>
            ${mission.rewards && mission.rewards.length > 0 ? `
              <span class="px-2 md:px-3 py-1 bg-yellow-100 text-yellow-700 rounded-full text-xs md:text-sm font-medium">
                <i class="fas fa-gift mr-1"></i>${mission.rewards.length} rewards
              </span>
            ` : ''}
          </div>
          <button class="w-full sm:w-auto px-3 md:px-4 py-1.5 md:py-2 bg-gradient-to-r from-purple-500 to-blue-500 text-white rounded-lg font-medium hover:shadow-lg transition-all text-xs md:text-sm ${
            mission.completed ? 'opacity-50 cursor-not-allowed' : mission.locked ? 'opacity-30 cursor-not-allowed' : 'hover:from-purple-600 hover:to-blue-600'
          }" ${mission.completed || mission.locked ? 'disabled' : ''}>
            ${mission.completed ? '‚úÖ Completed' : mission.locked ? 'üîí Locked' : 'üöÄ Start Mission'}
          </button>
        </div>
      `;
      
      if (!mission.completed && !mission.locked) {
        card.addEventListener('click', () => openMissionModal(mission));
      }
      
      return card;
    }

    // Helper function for difficulty colors
    function getDifficultyColor(difficulty) {
      switch(difficulty) {
        case 'easy': return 'bg-green-100 text-green-700';
        case 'medium': return 'bg-yellow-100 text-yellow-700';
        case 'hard': return 'bg-orange-100 text-orange-700';
        case 'expert': return 'bg-red-100 text-red-700';
        default: return 'bg-gray-100 text-gray-700';
      }
        
    }

    // Render weekly missions
    function renderWeeklyMissions() {
      const grid = document.getElementById('weeklyGrid');
      grid.innerHTML = '';
      
      weeklyMissions.forEach(mission => {
        const card = document.createElement('div');
        card.className = 'glass rounded-xl md:rounded-2xl p-4 sm:p-5 md:p-6';
        
        const progressPercent = (mission.progress / mission.target) * 100;
        
        card.innerHTML = `
          <div class="flex items-start justify-between mb-3 md:mb-4">
            <div class="flex items-center space-x-2 md:space-x-3 flex-1 min-w-0">
              <div class="w-10 h-10 md:w-12 md:h-12 rounded-full bg-gradient-to-r from-orange-500 to-red-500 flex items-center justify-center text-white flex-shrink-0">
                <i class="${mission.icon} text-sm md:text-base"></i>
              </div>
              <div class="min-w-0 flex-1">
                <h3 class="font-bold text-gray-900 text-sm md:text-base lg:text-lg truncate">${mission.title}</h3>
                <p class="text-xs md:text-sm text-gray-600">${mission.deadline}</p>
              </div>
            </div>
            <div class="text-right flex-shrink-0 ml-2">
              <div class="text-sm md:text-lg font-bold gradient-text">${mission.xp} XP</div>
            </div>
          </div>
          
          <p class="text-gray-600 mb-3 md:mb-4 text-sm md:text-base leading-relaxed">${mission.description}</p>
          
          <div class="mb-3 md:mb-4">
            <div class="flex justify-between text-xs md:text-sm text-gray-600 mb-2">
              <span>Progress</span>
              <span>${mission.progress}/${mission.target}</span>
            </div>
            <div class="w-full bg-gray-200 rounded-full h-2">
              <div class="progress-bar bg-gradient-to-r from-orange-500 to-red-500 h-2 rounded-full transition-all duration-500" 
                   style="width: ${progressPercent}%"></div>
            </div>
          </div>
        `;
        
        grid.appendChild(card);
      });
    }

    // Render leaderboard
    function renderLeaderboard() {
      const leaderboard = document.getElementById('leaderboard');
      leaderboard.innerHTML = '';
      
      leaderboardData.forEach(user => {
        const item = document.createElement('div');
        item.className = `leaderboard-item flex items-center justify-between p-3 md:p-4 rounded-lg transition-all duration-300 ${
          user.isCurrentUser ? 'bg-purple-50 border-2 border-purple-200' : 'hover:bg-gray-50'
        }`;
        
        item.innerHTML = `
          <div class="flex items-center space-x-2 md:space-x-4 flex-1 min-w-0">
            <div class="w-6 h-6 md:w-8 md:h-8 rounded-full bg-gradient-to-r from-purple-500 to-blue-500 flex items-center justify-center text-white font-bold text-xs md:text-sm flex-shrink-0">
              ${user.rank <= 3 ? ['ü•á', 'ü•à', 'ü•â'][user.rank - 1] : user.rank}
            </div>
            <div class="text-lg md:text-2xl flex-shrink-0">${user.avatar}</div>
            <div class="min-w-0 flex-1">
              <div class="font-semibold text-gray-900 text-sm md:text-base truncate ${user.isCurrentUser ? 'text-purple-700' : ''}">${user.name}</div>
              <div class="text-xs md:text-sm text-gray-600">${user.streak} day streak</div>
            </div>
          </div>
          <div class="text-right flex-shrink-0 ml-2">
            <div class="font-bold text-gray-900 text-sm md:text-base">${user.xp.toLocaleString()} XP</div>
          </div>
        `;
        
        leaderboard.appendChild(item);
      });
    }

    // Render achievements
    function renderAchievements() {
      const grid = document.getElementById('achievementsGrid');
      grid.innerHTML = '';
      
      achievements.forEach(achievement => {
        const card = document.createElement('div');
        card.className = `glass rounded-xl md:rounded-2xl p-4 md:p-6 text-center ${achievement.earned ? 'achievement-badge' : 'opacity-60'}`;
        
        card.innerHTML = `
          <div class="w-12 h-12 md:w-16 md:h-16 rounded-full bg-gradient-to-r from-yellow-400 to-orange-500 flex items-center justify-center text-white text-lg md:text-2xl mx-auto mb-3 md:mb-4 ${
            achievement.earned ? '' : 'grayscale'
          }">
            <i class="${achievement.icon}"></i>
          </div>
          <h3 class="font-bold text-gray-900 mb-2 text-sm md:text-base">${achievement.title}</h3>
          <p class="text-xs md:text-sm text-gray-600 mb-3 leading-relaxed">${achievement.description}</p>
          <div class="text-xs font-medium uppercase tracking-wide ${
            achievement.rarity === 'common' ? 'text-gray-500' :
            achievement.rarity === 'uncommon' ? 'text-green-500' :
            achievement.rarity === 'rare' ? 'text-blue-500' : 'text-purple-500'
          }">${achievement.rarity}</div>
          ${achievement.progress !== undefined ? `
            <div class="mt-3">
              <div class="text-xs text-gray-600 mb-1">${achievement.progress}/${achievement.target}</div>
              <div class="w-full bg-gray-200 rounded-full h-1">
                <div class="bg-gradient-to-r from-yellow-400 to-orange-500 h-1 rounded-full transition-all duration-500" 
                     style="width: ${(achievement.progress / achievement.target) * 100}%"></div>
              </div>
            </div>
          ` : ''}
        `;
        
        grid.appendChild(card);
      });
    }

    // Category filters
    function initializeCategoryFilters() {
      const filters = document.querySelectorAll('.category-filter');
      
      filters.forEach(filter => {
        filter.addEventListener('click', () => {
          // Remove active class from all filters
          filters.forEach(f => f.classList.remove('active'));
          // Add active class to clicked filter
          filter.classList.add('active');
          
          const category = filter.dataset.category;
          filterMissions(category);
        });
      });
    }

    function filterMissions(category) {
      const missionCards = document.querySelectorAll('#missionGrid .mission-card');
      
      missionCards.forEach(card => {
        const mission = missions.find(m => card.innerHTML.includes(m.title));
        if (category === 'all' || mission.category === category) {
          card.style.display = 'block';
          card.style.animation = 'fadeInUp 0.5s ease-out';
        } else {
          card.style.display = 'none';
        }
      });
    }

    // Mission modal
    function openMissionModal(mission) {
      const modal = document.getElementById('missionModal');
      const modalTitle = document.getElementById('modalTitle');
      const modalContent = document.getElementById('modalContent');
      
      modalTitle.textContent = mission.title;
      modalContent.innerHTML = `
        <div class="space-y-4 md:space-y-6">
          <div class="flex items-center space-x-3 md:space-x-4">
            <div class="w-12 h-12 md:w-16 md:h-16 rounded-full bg-gradient-to-r from-purple-500 to-blue-500 flex items-center justify-center text-white text-lg md:text-2xl flex-shrink-0">
              <i class="${mission.icon}"></i>
            </div>
            <div class="min-w-0 flex-1">
              <div class="text-lg md:text-2xl font-bold gradient-text">${mission.xp} XP</div>
              <div class="text-gray-600 text-sm md:text-base">${mission.timeEstimate} ‚Ä¢ ${mission.difficulty}</div>
            </div>
          </div>
          
          <p class="text-gray-700 text-sm md:text-base leading-relaxed">${mission.description}</p>
          
          <div>
            <h4 class="font-semibold text-gray-900 mb-2 text-sm md:text-base">Requirements:</h4>
            <ul class="list-disc list-inside text-gray-600 space-y-1 text-sm md:text-base">
              ${mission.requirements.map(req => `<li>${req}</li>`).join('')}
            </ul>
          </div>
          
          <div>
            <h4 class="font-semibold text-gray-900 mb-2 text-sm md:text-base">Rewards:</h4>
            <ul class="list-disc list-inside text-gray-600 space-y-1 text-sm md:text-base">
              ${mission.rewards.map(reward => `<li>${reward}</li>`).join('')}
            </ul>
          </div>
          
          <div class="flex flex-col sm:flex-row gap-3 md:gap-4 pt-2">
            <button class="flex-1 px-4 md:px-6 py-2.5 md:py-3 bg-gradient-to-r from-purple-500 to-blue-500 text-white rounded-lg font-medium hover:shadow-lg transition-all text-sm md:text-base" 
                    onclick="startMission(${mission.id})">
              Start Mission
            </button>
            <button class="px-4 md:px-6 py-2.5 md:py-3 border border-gray-300 text-gray-700 rounded-lg font-medium hover:bg-gray-50 transition-all text-sm md:text-base" 
                    onclick="closeMissionModal()">
              Cancel
            </button>
          </div>
        </div>
      `;
      
      modal.classList.remove('hidden');
    }

    function closeMissionModal() {
      document.getElementById('missionModal').classList.add('hidden');
    }

    function startMission(missionId) {
      // Simulate mission start
      showNotification('Mission Started!', 'Good luck with your mission!');
      closeMissionModal();
      
      // In a real app, this would redirect to the mission content
      console.log(`Starting mission ${missionId}`);
    }

    // Close modal when clicking outside
    document.getElementById('missionModal').addEventListener('click', (e) => {
      if (e.target.id === 'missionModal') {
        closeMissionModal();
      }
    });

    document.getElementById('closeModal').addEventListener('click', closeMissionModal);

    // Notification system
    function showNotification(title, message) {
      const notification = document.getElementById('notification');
      const notificationTitle = document.getElementById('notificationTitle');
      const notificationMessage = document.getElementById('notificationMessage');
      
      notificationTitle.textContent = title;
      notificationMessage.textContent = message;
      
      notification.classList.remove('hidden');
      
      setTimeout(() => {
        notification.classList.add('hidden');
      }, 3000);
    }

    // Scroll indicator
    function initializeScrollIndicator() {
      const scrollIndicator = document.getElementById('scrollIndicator');
      
      window.addEventListener('scroll', () => {
        const scrollTop = window.pageYOffset;
        const docHeight = document.body.offsetHeight - window.innerHeight;
        const scrollPercent = (scrollTop / docHeight) * 100;
        
        scrollIndicator.style.width = scrollPercent + '%';
      });
    }

    // Mission completion function
    function completeMission(missionId) {
      const mission = missions.find(m => m.id === missionId);
      if (mission && !mission.completed) {
        // Update mission data using data manager
        const updatedData = dataManager.completeMission(mission);
        
        // Re-render missions
        renderMissions();
        
        // Show success notification
        showNotification('Mission Completed!', `You earned ${mission.xp} XP! Total: ${updatedData.totalXP.toLocaleString()}`);
        
        // Add celebration effect
        createCelebrationEffect();
        
        // Check for achievements
        checkAchievements(updatedData);
      }
    }

    // Create celebration effect
    function createCelebrationEffect() {
      // Create confetti-like effect
      for (let i = 0; i < 20; i++) {
        setTimeout(() => {
          const confetti = document.createElement('div');
          confetti.className = 'fixed w-2 h-2 bg-yellow-400 rounded-full pointer-events-none z-50';
          confetti.style.left = Math.random() * window.innerWidth + 'px';
          confetti.style.top = '-10px';
          confetti.style.animation = 'fall 3s linear forwards';
          document.body.appendChild(confetti);
          
          setTimeout(() => confetti.remove(), 3000);
        }, i * 100);
      }
    }

    // Check for new achievements
    function checkAchievements(data) {
      achievements.forEach(achievement => {
        if (!achievement.earned) {
          let shouldEarn = false;
          
          switch (achievement.id) {
            case 'a1':
              shouldEarn = data.completedMissions >= 1;
              break;
            case 'a2':
              shouldEarn = data.currentStreak >= 7;
              break;
            case 'a3':
              // Update progress for coding challenges
              if (achievement.progress < 50) {
                achievement.progress = Math.min(achievement.progress + 1, 50);
                shouldEarn = achievement.progress >= 50;
              }
              break;
          }
          
          if (shouldEarn) {
            achievement.earned = true;
            showNotification('Achievement Unlocked!', `${achievement.title} - ${achievement.description}`);
          }
        }
      });
      
      renderAchievements();
    }

    // Add CSS for confetti animation
    const style = document.createElement('style');
    style.textContent = `
      @keyframes fall {
        to {
          transform: translateY(100vh) rotate(360deg);
          opacity: 0;
        }
      }
    `;
    document.head.appendChild(style);

    // Demo: Complete a mission after 5 seconds (remove in production)
    setTimeout(() => {
      if (!missions[0].completed) {
        completeMission(1);
      }
    }, 5000);
  </script>
</body>
</html>